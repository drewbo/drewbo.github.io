<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='http://fonts.googleapis.com/css?family=Noticia+Text:400,700' rel='stylesheet' type='text/css' />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="../../../../../images/favicon.ico">
    <title> NikePlus Running Map | drewbo.com </title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans Pro:200italic,200,300italic,300,400italic,400,600italic,600,700italic,700,900italic,900" type="text/css">
    <link rel="stylesheet" href="../../../../../theme/css/style.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../theme/css/font-awesome.css" type="text/css"/>
			<link href="https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.css" rel="stylesheet" />
			<link rel="stylesheet" href="/css/nikerunningmap.css" type="text/css" />
  

  </head>
  <body>
    <div class=container>
<div class="header">
    <a class="title" href="../../../../../">drewbo.com</a> <span class="muted"></span>
</div>

<div class=navigation>
    <ul>
            <li><a href="../../../../../archives.html">Archive</a> </li>
            <li><a href="../../../../../pages/projects.html">Projects</a> </li>
            <li><a href="../../../../../pages/about-me.html">About</a> </li>
    </ul>
</div>        
        <div class=body>
    <h1 class="title"> NikePlus Running Map</h1>
    <p class=date> 07 29 2014 </p>
    <p>Inspired by Garrett Miller's (relatively) recent blog post, <a class="reference external" href="https://www.mapbox.com/blog/mapping-moves/">Mapping Moves</a>, I decided to do <a class="reference external" href="http://drewbo.com/blog/2014/05/12/nike-plus-elevation/">something else</a> with all my NikePlus data
and create a map of my runs.
Unfortunately for me, the Nike data is more difficult to liberate than from other sources. Fortunately for me, and anyone else trying
to do this, there are some pre-existing tools to solve this issue.</p>
<p></p>
<div id="map" class="map"></div><p class="center"><span class="blue">2012</span> in blue, <span class="orange">2013</span> in orange, <span class="green">2014</span> in green. View <a class="reference external" href="https://a.tiles.mapbox.com/v4/drewbo19.immnjfdh/page.html?access_token=pk.eyJ1IjoiZHJld2JvMTkiLCJhIjoiWlpRb2lYUSJ9.aT3CQyI2_wYzqKPDqjgvyw#13/38.9105/-77.0424">fullscreen</a></p>
<div class="section" id="before-starting">
<h2>Before starting</h2>
<p>Get these things:</p>
<ul class="simple">
<li><a class="reference external" href="https://www.python.org/">Python</a></li>
<li><a class="reference external" href="https://www.mapbox.com/tilemill/">TileMill</a></li>
<li>A <a class="reference external" href="https://www.mapbox.com/">MapBox</a> account</li>
<li><a class="reference external" href="https://github.com/mapbox/togeojson">togeojson</a></li>
</ul>
</div>
<div class="section" id="the-data">
<h2>The data</h2>
<p>First, I used <a class="reference external" href="https://mattstuehler.com/lab/NikePlus/">Matt Stuehler's site</a> (again) to export all of my runs as .gpx files. If you have trouble exporting them all at the same time,
it helps to break them up into 30-40 run groups.</p>
<p>The easiest way to import this data into TileMill is going to be as a .geojson file but it will help if we have our data a little more organized
before converting. I had three years of data so I decided that I would eventually want to style it by year. Here's the folder structure I used:</p>
<img alt="Folder Structure" class="align-center" src="/images/folder-structure.png" style="width: 600px; height: 430px;" />
<p>The Python file in each folder is a slight modification of <a class="reference external" href="https://github.com/kengggg/osm-gpx-download">one used for OpenStreetMap exports</a>. I'm going to post it here because I don't like having to
clone a GitHub repo just to grab one file.:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">output_file_name</span> <span class="o">=</span> <span class="s2">&quot;merged.gpx&quot;</span>

<span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#39;</span><span class="p">)</span>
<span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;gpx version=&quot;1.0&quot;&gt;&#39;</span><span class="p">)</span>

<span class="n">gpx_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*/*.gpx&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">gpx_file_name</span> <span class="ow">in</span> <span class="n">gpx_list</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Parsing &quot;</span><span class="o">+</span><span class="n">gpx_file_name</span><span class="o">+</span><span class="s2">&quot; ...&quot;</span>

    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">gpx_file_name</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">gpx_trace</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">gpx_trace</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">trk</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/gpx&gt;&#39;</span><span class="p">)</span>
<span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p>Copy this, save it as gpx-merger.py, and put one in each folder structure like I did above (it needs to be one folder &quot;below&quot; the data
it is aggregating). To run it, navigate to that folder in the command line/terminal and type &quot;python gpx-merger.py&quot;. Sit back and wait.</p>
<img alt="Terminal gif" class="align-center" src="/images/terminal.gif" style="width: 600px; height: 338px;" />
<p>Each time you run it in a new place, it will output a file called 'merged.gpx'.
Now you can pretty much follow the rest of <a class="reference external" href="https://www.mapbox.com/blog/mapping-moves/">Garrett's blog post</a>:</p>
<ul class="simple">
<li>Use togeojson to convert each merged file into a .geojson file</li>
<li>Start a new TileMill project and import each file as a separate layer</li>
<li>Style, then upload to MapBox</li>
</ul>
</div>
<div class="section" id="styling-tips">
<h2>Styling tips</h2>
<ul class="simple">
<li>Bright colors look awesome.</li>
<li>Set the 'line-opacity' attribute to ~0.25. This means that it will take four times over the same path to make the line fully opaque and gives a better idea of how often you run in certain areas.</li>
<li>Use the satellite imagery (requires a basic MapBox account) with a near-black color and saturated filter settings ( &gt;75%).</li>
</ul>
<img alt="filter settings" class="align-center" src="/images/filter-settings.png" style="width: 600px; height: 338px;" />
</div>

    

    <p class=tags>tags:
      <a href="../../../../../tag/blog.html">blog</a>
      <a href="../../../../../tag/nikeplus.html">nikeplus</a>
      <a href="../../../../../tag/running.html">running</a>
      <a href="../../../../../tag/mapbox.html">mapbox</a>
      <a href="../../../../../tag/tutorial.html">tutorial</a>
    </p>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'drewbo'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
        
<div class=footer>
  <p>&copy; Copyright <script language="JavaScript">var date = new Date(); document.write(date.getFullYear());</script> Drew Bollinger</p>
  <p> Powered by <a href="http://pypi.python.org/pypi/pelican/" target="_blank">Pelican</a>.  
    <a href="../../../../../pages/theme-info.html">Theme and Style Info</a>  
  </p> 
  <p>
    <div class=social style="font-size: 27px;">
      <ul>
        <script language="JavaScript">
          u = 'drew';
          s = 'drewbo.com';
          document.write('<a href=\"mailto:' + u + '@' + s + '\" target=\"_blank\">');
        </script>
            <li><i class="icon-envelope icon-large"></i> </li>
        </a>
	
        <a href="http://twitter.com/drewbo19" target="_blank"> <li> <i class="icon-twitter-sign icon-large"> </li></i> </a>
        <a href="https://www.linkedin.com/profile/view?id=92384606" target="_blank"><li><i class="icon-linkedin-sign icon-large" ></i></li></a>
        <a href="https://github.com/drewbo" target="_blank"> <li> <i class="icon-github-sign icon-large"></i> </li> </a>
   
        


        <a href="../../../../../feeds/all.rss.xml" rel="alternate" title="Recent Blog Posts"><li> <i class="icon-rss icon-large"></i> </li></a>
      </ul>
    </div>
  </p>
</div>    </div>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-50610868-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
				<script src="https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js"></script>
				<script src="/js/nikerunningmap.js"></script>
</html>
